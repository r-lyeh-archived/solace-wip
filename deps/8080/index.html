<!-- -- lovebird -- -- Copyright (c) 2014, rxi -- -- This library is free software; you can redistribute it and/or modify it -- under the terms of the MIT license. See LICENSE for details. -- -- https://github.com/rxi/lovebird --> <!doctype html> <html lang="en"> <head> <meta http-equiv="x-ua-compatible" content="IE=Edge" charset="utf-8" /> <title>{TITLE}</title> <link rel='stylesheet' type='text/css' href='.solace.colors.css' /> <script type="text/javascript" src="https://cdn.rawgit.com/ajaxorg/ace-builds/master/src-noconflict/ace.js" charset="utf-8"></script> <link rel="stylesheet" type='text/css' href="https://rawgit.com/t4t5/sweetalert/master/lib/sweet-alert.css"> <script type="text/javascript" src="https://cdn.rawgit.com/t4t5/sweetalert/master/lib/sweet-alert.min.js"></script> <script language='javascript'> $w=window,$n=navigator,$d=document,$r=$d.documentElement,$h=$("head")[0],$b=$("body")[0],$ie=$n.appVersion.match(/MSIE ([\d.]+)/),$ie=$ie?$ie[1]:0;$m=0<=$n.userAgent.indexOf("mobile");"AbbrArticleAsideAudioCanvasDetailsFigureFooterHeaderHgroupMarkMenuMeterNavOutputProgressSectionTimeVideo".replace(/.[a-z]+/g,function(a){document.createElement(a)});$w.getComputedStyle||(window.getComputedStyle=function(a){this.el=a;this.getPropertyValue=function(b){var c=/(\-([a-z]){1})/g;"float"==b&&(b="styleFloat");c.test(b)&&(b=b.replace(c,function(a,b,c){return c.toUpperCase()}));return a.currentStyle[b]?a.currentStyle[b]:null};return this});function $(a){if("#"==a.charAt(0))return $d.getElementById(a.substr(1));if("."==a.charAt(0)){if($d.getElementsByClassName)return $d.getElementsByClassName(a.substr(1));for(var b=[],a=RegExp("(^| )"+a.substr(1)+"( |$)"),c=$("*"),d=0,e=c.length;d<e;d++)a.test(c[d].className)&&b.push(c[d]);return b}return $d.getElementsByTagName(a)}function remove(a){a.parentNode.removeChild(a)}function on(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function off(a,b,c){a.removeEventListener?a.removeEventListener(b,c):a.detachEvent("on"+b,c)}function css(a,b,c){if(c)a.style[b]=c;else return $w.getComputedStyle(a).getPropertyValue(b)}function each(a,b){var c,l=a.length;for(c=0;c<l;c++)b.call(a[c])} function getElementsByClass(searchClass,node,tag) { var classElements = new Array(); if ( node == null ) node = document; if ( tag == null ) tag = '*'; var elements = node.getElementsByTagName(tag); var elementsSize = elements.length; var pattern = new RegExp("(^|\\s)" + searchClass + "(\\s|$)"); for (i = 0, j = 0; i < elementsSize; i++) { if ( pattern.test(elements[i].className) ) { classElements[j] = elements[i]; j++; }} return classElements; }; function style(id) { return document.getElementById(id).style; } function show(id) { style(id).display = 'inline'; }; function hide(id) { style(id).display = 'none'; }; function vis(id) { return style(id).display; }; function toggle(id) { if( vis(id) == 'inline' ) hide(id); else show(id); } function toggleVis(className) { var elements = getElementsByClass(className); var pattern = new RegExp("(^|\\s)Button(\\s|$)"); for(i = 0; i < elements.length; i++) { if(!pattern.test(elements[i].className)) { if(elements[i].style.display != 'none') elements[i].style.display = 'none'; else elements[i].style.display = 'inline' }}}; function setVis(className, kind) { kind = kind ? 'inline' : 'none'; var elements = getElementsByClass(className); var pattern = new RegExp("(^|\\s)Button(\\s|$)"); for(i = 0; i < elements.length; i++) { if(!pattern.test(elements[i].className)) { elements[i].style.display = kind; }}}; function addClass(element, classToAdd) { var currentClassValue = element.className; if (currentClassValue.indexOf(classToAdd) == -1) { if ((currentClassValue == null) || (currentClassValue === "")) { element.className = classToAdd; } else { element.className += " " + classToAdd; } } }; function hasClass(element, className) { var currentClassValue = element.className; if (currentClassValue == className) { return true; } else { var classValues = currentClassValue.split(" "); for (var i = 0 ; i < classValues.length; i++) { if (className == classValues[i]) { return true; } } } return false; }; function removeClass(element, classToRemove) { var currentClassValue = element.className; var found = 0; if (currentClassValue == classToRemove) { element.className = ""; found++; } else { var classValues = currentClassValue.split(" "); var filteredList = []; for (var i = 0 ; i < classValues.length; i++) { if (classToRemove != classValues[i]) { filteredList.push(classValues[i]); } else { found ++; } } element.className = filteredList.join(" "); } return found; }; function toggleClass(element, className) { if( !hasClass(element, className) ) addClass(element, className); else removeClass(element, className); }; function Query(selector) { var element = document.querySelector(selector); return element; }; </script> <style type="text/css" media="screen"> #editorwin { position: absolute; top: 0; right: 0; bottom: 0; left: 0; text-align: center; } #editor { text-align: left; position: absolute; top: 20px; right: 0; bottom: 0; left: 0; } </style> <style type='text/css'> pre { display:none; } .black_bg { background-color:#000000; }; a { color:#ff0000; background-color:#ffffff; padding:3px; font-size:small; text-decoration: none; width:5em; font-weight:normal; cursor: hand; border-radius:4px; } h1 { padding-top: 3em; } body { font-family:"Calibri"; padding-top: 0; margin-top: 0; } p { font-family:"Calibri"; padding:4px; border-radius:5px; margin:2px; display:block; } img { float: none; } .Header { position:fixed; background:#ffffff; padding-bottom:1em; } .Padding { height:20em; } .time { float: left; width:10em; background-color:transparent; } .Button { width:5em; border:none; border-radius: 5px; padding:4px; margin:2px; cursor: pointer; vertical-align: middle; font-family: "Calibri", helvetica, verdana, sans; } .Button2 { padding-top: 0px; padding-bottom: 0px; vertical-align: middle; } </style><style> body { margin: 0px; font-size: 15px; font-family: "Calibri", helvetica, verdana, sans; background: #FFFFFF; } form { margin-bottom: 0px; } iframe { border: 0; width: 100%; height: 100%; } .timestamp { color: #909090; padding-right: 4px; } .repeatcount_light { color: #F0F0F0; background: #505050; } .repeatcount { font-size: 11px; font-weight: bold; text-align: center; padding-left: 4px; padding-right: 4px; padding-top: 0px; padding-bottom: 0px; border-radius: 7px; display: inline-block; vertical-align: middle; } .errormarker { color: #F0F0F0; background: #8E0000; font-size: 11px; font-weight: bold; text-align: center; border-radius: 8px; width: 17px; padding-top: 0px; padding-bottom: 0px; display: inline-block; } .greybordered { margin: 12px; background: #F0F0F0; border: 1px solid #E0E0E0; border-radius: 3px; } .monospaced, .inputline { font-family: mono, courier; font-size: 13px; color: #606060; } .inputline:before { content: '\00B7\00B7\00B7'; padding-right: 5px; } .errorline { color: #8E0000; } #header { background: #101010; height: 25px; color: #F0F0F0; padding: 9px } #title { float: left; font-size: 20px; } #title a { color: #F0F0F0; text-decoration: none; } #title a:hover { color: #FFFFFF; } #subtitle { font-size: 10px; } #status { float: right; font-size: 14px; padding-top: 4px; } #main a { color: #000000; text-decoration: none; background: #E0E0E0; border: 1px solid #D0D0D0; border-radius: 3px; padding-left: 2px; padding-right: 2px; display: inline-block; } #main a:hover { background: #D0D0D0; border: 1px solid #C0C0C0; } #sliders { position: absolute; top: 40px; bottom: 0px; left: 0px; width: 300px; } #console { position: absolute; top: 40px; bottom: 0px; left: 312px; right: 312px; } #input { position: absolute; margin: 10px; bottom: 0px; left: 0px; right: 0px; } #inputbox { width: 100%; font-family: mono, courier; font-size: 13px; } #output { overflow-y: scroll; position: absolute; margin: 10px; line-height: 17px; top: 0px; bottom: 36px; left: 0px; right: 0px; } #env { position: absolute; top: 40px; bottom: 0px; right: 0px; width: 300px; } #envheader { padding: 5px; background: #E0E0E0; } #envvars { position: absolute; left: 0px; right: 0px; top: 25px; bottom: 0px; margin: 10px; overflow-y: scroll; font-size: 12px; } </style> </head> <body> <div id="header"> <div id="title"> <a href="{URL}" class="black_bg">{TITLE}</a> <span id="subtitle">{SUBTITLE}</span> </div> <div id="status"></div> <span id="interface"></span> <span> <input list="tocs" name="toc" oninput="load(this.value);"> <datalist id="tocs"></datalist> </span> </div> <div id="main"> <div id="console" class="greybordered"> <div id="output">{BUFFER}</div> <div id="input"> <form method="post" onkeydown="return onInputKeyDown(event);" onsubmit="onInputSubmit(); return false;"> <input id="inputbox" name="input" type="text"></input> </form> </div> </div> <div id="env" class="greybordered"> <div id="envheader"></div> <div id="envvars"></div> </div> <div id="sliders" class="greybordered"> <iframe src="http://localhost:10002/"></iframe> </div> <div id="editorwin" class="greybordered" style="display:none"> <div style="width:auto;overflow:scroll;max-height:200px;"><a href='#' id="editortitle" onclick="javascript:hide('editorwin');" style="width:100%"></a></div> <div id="editor"></div> </div> </div> <script> document.getElementById("inputbox").focus(); var changeFavicon = function(href) { var old = document.getElementById("favicon"); if (old) document.head.removeChild(old); var link = document.createElement("link"); link.id = "favicon"; link.rel = "shortcut icon"; link.href = href; document.head.appendChild(link); }; var truncate = function(str, len) { if (str.length <= len) return str; return str.substring(0, len - 3) + "..."; }; var geturl = function(url, onComplete, onFail) { var req = new XMLHttpRequest(); req.onreadystatechange = function() { if (req.readyState != 4) return; if (req.status == 200) { if (onComplete) onComplete(req.responseText); } else { if (onFail) onFail(req.responseText); } }; url += (url.indexOf("?") > -1 ? "&_=" : "?_=") + Math.random(); req.open("GET", url, true); req.send(); }; var serialize = function(obj, prefix) { var str = []; for(var p in obj) { if (obj.hasOwnProperty(p)) { var k = prefix ? prefix + "[" + p + "]" : p, v = obj[p]; str.push(typeof v == "object" ? serialize(v, k) : encodeURIComponent(k) + "=" + encodeURIComponent(v)); } } return str.join("&"); }; var postfile = function(url, name, data, onComplete, onFail) { var req = new XMLHttpRequest(); req.open("POST", url, true); req.onreadystatechange = function() { if (req.readyState != 4) return; if (req.status == 200) { if (onComplete) onComplete(req.responseText); } else { if (onFail) onFail(req.responseText); } }; var formData = new FormData(); formData.append(name, data); req.send(formData); }; var posturl = function(url, options, onComplete, onFail) { var req = new XMLHttpRequest(); req.open("POST", url, true); req.setRequestHeader("Content-type","application/x-www-form-urlencoded"); req.onreadystatechange = function() { if (req.readyState != 4) return; if (req.status == 200) { if (onComplete) onComplete(req.responseText); } else { if (onFail) onFail(req.responseText); } }; var options = serialize(options); req.send(options); }; var divContentCache = {}; var getDivContent = function(id) { return document.getElementById(id).innerHTML; }; var updateDivContent = function(id, content) { if (divContentCache[id] != content) { document.getElementById(id).innerHTML = content; divContentCache[id] = content; return true; }; return false; }; var onInputSubmit = function() { var b = document.getElementById("inputbox"); var req = new XMLHttpRequest(); req.open("POST", "/", true); req.send("input=" + encodeURIComponent(b.value)); if (b.value && inputHistory[0] != b.value) { inputHistory.unshift(b.value); }; inputHistory.index = -1; b.value = ""; refreshOutput(); }; var inputHistory = []; inputHistory.index = 0; var onInputKeyDown = function(e) { var key = e.which || e.keyCode; if (key != 38 && key != 40) return true; var b = document.getElementById("inputbox"); if (key == 38 && inputHistory.index < inputHistory.length - 1) { inputHistory.index++; }; if (key == 40 && inputHistory.index >= 0) { inputHistory.index--; }; b.value = inputHistory[inputHistory.index] || ""; b.selectionStart = b.value.length; return false; }; var bufferLocation = "/buffer"; var refreshOutput = function() { geturl(bufferLocation, function(text) { updateDivContent("status", "connected &#9679;"); if (updateDivContent("output", text)) { var div = document.getElementById("output"); div.scrollTop = div.scrollHeight; }; changeFavicon("data:image/png;base64," + "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAP1BMVEUAAAAAAAAAAAD/"+"/"+"/"+"/19fUO"+ "Dg7v7+/h4eGzs7MlJSUeHh7n5+fY2NjJycnGxsa3t7eioqKfn5+QkJCHh4d+fn7zU+b5AAAAAnRS"+ "TlPlAFWaypEAAABRSURBVBjTfc9HDoAwDERRQ+w0ern/WQkZaUBC4e/mrWzppH9VJjbjZg1Ii2rM"+ "DyR1JZ8J0dVWggIGggcEwgbYCRbuPRqgyjHNpzUP+39GPu9fgloC5L9DO0sAAAAASUVORK5CYII=" ); }, function(text) { updateDivContent("status", "disconnected &#9675;"); changeFavicon("data:image/png;base64," + "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAYFBMVEUAAAAAAAAAAADZ2dm4uLgM"+ "DAz29vbz8/Pv7+/h4eHIyMiwsLBtbW0lJSUeHh4QEBDn5+fS0tLDw8O0tLSioqKfn5+QkJCHh4d+"+ "fn5ycnJmZmZgYGBXV1dLS0tFRUUGBgZ0He44AAAAAnRSTlPlAFWaypEAAABeSURBVBjTfY9HDoAw"+ "DAQD6Z3ey/9/iXMxkVDYw0g7F3tJReosUKHnwY4pCM+EtOEVXrb7wVRA0dMbaAcUwiVeDQq1Jp4a"+ "xUg5kE0ooqZu68Di2Tgbs/DiY/9jyGf+AyFKBAK7KD2TAAAAAElFTkSuQmCC" ); }); geturl(".solace.interface.ajax", function(text) { updateDivContent("interface", text); }, function(text) { }); geturl(".solace.toc.ajax", function(text) { updateDivContent("tocs", text); }, function(text) { }); }; setInterval(refreshOutput, {TIMEOUT} * 1000); var load = function(prebuffer) { bufferLocation = prebuffer; }; var alert = function(txt, ok) { if(ok) sweetAlert("Ok!", txt, "success"); else sweetAlert({ title: "Error!", text: txt, type: "error", confirmButtonColor: "#484848", confirmButtonText: "OK", closeOnConfirm: true }, function(){ } ); }; var confirm = function(txt, fn) { sweetAlert({ title: "Are you sure?", text: "Local changes will be discarded", type: "warning", showCancelButton: true, confirmButtonColor: "#DD6B55", confirmButtonText: "Yes, exit now!", closeOnConfirm: true }, function(){ fn.call(); } ); return true; }; var editing = ''; var save = function( ok_cb, err_cb ) { postfile('/fwrite', editing, editor.getSession().getValue(), ok_cb, err_cb ); editor.getSession().getUndoManager().reset(); editor.getSession().getUndoManager().markClean(); }; var edit = function(file_colon_line) { var arr = file_colon_line.split(':'); var line = parseInt(arr[arr.length - 1]); var file = (arr.pop(), arr.join(':')); editing = file; geturl("/fread?fp="+file, function(text) { show("editorwin"); updateDivContent("editortitle", file + " (CTRL-Q: <u>q</u>uit, CTRL-S: <u>s</u>ave doc)"); editor.getSession().setValue("bla bla"); editor.getSession().setValue(text); editor.gotoLine(line,0,false); editor.focus(); editor.getSession().getUndoManager().reset(); editor.getSession().getUndoManager().markClean(); editor.commands.addCommand({ name: 'nav_down.', bindKey: {win: 'Ctrl-S', mac: 'Command-S'}, exec: function(editor) { if( editor.getSession().getUndoManager().hasUndo() == true ) { save( function() { alert("document saved", 1); }, function() { alert("failed while saving"); } ); } }, readOnly: true }); editor.commands.addCommand({ name: 'escape1.', bindKey: {win: 'Esc', mac: 'Esc'}, exec: function(editor) { if( editor.getSession().getUndoManager().hasUndo() == true ) confirm("exit?", function() { hide("editorwin"); }); else hide("editorwin"); }, readOnly: true }); editor.commands.addCommand({ name: 'escape2.', bindKey: {win: 'Ctrl-Q', mac: 'Command-Q'}, exec: function(editor) { if( editor.getSession().getUndoManager().hasUndo() == true ) confirm("exit?", function() { hide("editorwin"); }); else hide("editorwin"); }, readOnly: true }); }, function(text) { alert('error:' + text); hide("editorwin"); }); }; var trace = function(id,json) { if( getDivContent(id).length == 0 ) { updateDivContent(id, "<xmp>Connecting...</xmp>"); geturl("/stacktrace.text?p=" + json, function(text) { var html = '', arr = text.split("\n"); for(i = 0; i < arr.length; i++) { html = html + '<li>' + arr[i] + '</li>'; } html = '<ol>' + html + '</ol>'; updateDivContent(id, html); }, function(text) { updateDivContent(id, "<xmp>ajax error :(</xmp>"); }); } toggle(id); }; var envPath = ""; var refreshEnv = function() { geturl("/env.json?p=" + envPath, function(text) { var json = eval("(" + text + ")"); var html = "<a href='#' onclick=\"setEnvPath('')\">env</a>"; var acc = ""; var p = json.path != "" ? json.path.split(".") : []; for (var i = 0; i < p.length; i++) { acc += "." + p[i]; html += " <a href='#' onclick=\"setEnvPath('" + acc + "')\">" + truncate(p[i], 10) + "</a>"; }; updateDivContent("envheader", html); if (!json.valid) { updateDivContent("envvars", "Bad path"); return; }; var html = "<table>"; for (var i = 0; json.vars[i]; i++) { var x = json.vars[i]; var fullpath = (json.path + "." + x.key).replace(/^\./, ""); var k = truncate(x.key, 15); if (x.type == "table") { k = "<a href='#' onclick=\"setEnvPath('" + fullpath + "')\">" + k + "</a>"; }; var v = "<a href='#' onclick=\"insertVar('" + fullpath.replace(/\.(-?[0-9]+)/g, "[$1]") + "');\">" + x.value + "</a>"; html += "<tr><td>" + k + "</td><td>" + v + "</td></tr>"; }; html += "</table>"; updateDivContent("envvars", html); }); }; var setEnvPath = function(p) { envPath = p; refreshEnv(); }; var insertVar = function(p) { var b = document.getElementById("inputbox"); b.value += p; b.focus(); }; setInterval(refreshEnv, {TIMEOUT} * 1000); </script> <script> var editor = ace.edit("editor"); editor.setTheme("ace/theme/monokai"); editor.getSession().setMode("ace/mode/c_cpp"); </script> </body> </html>